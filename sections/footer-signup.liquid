{% comment %}
  Newsletter banner (Tashola)
  - Matches screenshot: centered line of copy, input + dark button
  - Automatically tags contacts as "newsletter" for Shopify Email segments
{% endcomment %}

<section class="ts-newsletter" role="region" aria-label="Newsletter">
  <div class="ts-newsletter__wrap page-width">
    {% if section.settings.copy != blank %}
      <p class="ts-newsletter__copy">{{ section.settings.copy }}</p>
    {% endif %}

    {% form 'customer', class: 'ts-newsletter__form', id: "NewsletterForm-#{section.id}" %}
      <input type="hidden" name="contact[tags]" value="newsletter">

      <label for="NewsletterEmail-{{ section.id }}" class="visually-hidden">
        {{ section.settings.placeholder }}
      </label>
      <input
        id="NewsletterEmail-{{ section.id }}"
        type="email"
        name="contact[email]"
        class="ts-newsletter__input"
        value="{{ form.email }}"
        autocorrect="off"
        autocapitalize="off"
        autocomplete="email"
        placeholder="{{ section.settings.placeholder }}"
        required
      >
      <button type="submit" class="ts-newsletter__btn">{{ section.settings.button_label }}</button>

      {% if form.posted_successfully? %}
        <p class="ts-newsletter__msg ts-newsletter__msg--success">{{ section.settings.success_message }}</p>
      {% elsif form.errors %}
        <p class="ts-newsletter__msg ts-newsletter__msg--error">
          {{ form.errors.translated_fields['email'] | default: form.errors.messages['email'] }}
        </p>
      {% endif %}
    {% endform %}
  </div>

  <style>
    .ts-newsletter {
      background: {{ section.settings.bg_color }};
      border-top: 1px solid rgba(0,0,0,.06);
      border-bottom: 1px solid rgba(0,0,0,.06);
      padding: 22px 0;
    }
    .ts-newsletter .page-width { max-width: 1200px; margin: 0 auto; padding: 0 16px; }

    .ts-newsletter__copy {
      margin: 0 0 14px;
      text-align: center;
      font-style: italic;
      font-size: 16px;
      line-height: 1.5;
      color: {{ section.settings.copy_color }};
      letter-spacing: .2px;
    }

    .ts-newsletter__form {
      display: flex;
      justify-content: center;
      align-items: stretch;
      gap: 0;
      flex-wrap: nowrap;
    }

    .ts-newsletter__input {
      background: #fff;
      border: 1px solid {{ section.settings.input_border }};
      border-right: none;
      padding: 12px 14px;
      min-width: 280px;
      font-size: 14px;
      line-height: 1.2;
      color: #333;
    }

    .ts-newsletter__btn {
      background: {{ section.settings.btn_bg }};
      color: {{ section.settings.btn_text }};
      border: 1px solid {{ section.settings.btn_bg }};
      padding: 12px 28px;
      font-size: 14px;
      letter-spacing: .2px;
      cursor: pointer;
      transition: opacity .2s ease;
    }
    .ts-newsletter__btn:hover { opacity: .9; }

    .ts-newsletter__msg { margin: 8px 0 0; text-align: center; font-size: 13px; }
    .ts-newsletter__msg--success { color: #0a7f43; }
    .ts-newsletter__msg--error { color: #b71818; }

    .visually-hidden {
      position: absolute !important; height:1px; width:1px; overflow:hidden;
      clip: rect(1px,1px,1px,1px); white-space: nowrap;
    }

    @media (max-width: 749px) {
      .ts-newsletter__form { flex-wrap: wrap; }
      .ts-newsletter__input { width: 100%; border-right: 1px solid {{ section.settings.input_border }}; margin-bottom: 8px; }
      .ts-newsletter__btn { width: 100%; }
    }
  </style>
</section>

{% schema %}
{
  "name": "Newsletter banner",
  "tag": "section",
  "class": "section newsletter-banner-section",
  "settings": [
    {
      "type": "text",
      "id": "copy",
      "label": "Banner copy",
      "default": "Sign up for early-access sales, exclusive offers, new arrivals and more."
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Email placeholder",
      "default": "Email Address"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Join Now"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success message",
      "default": "Thanks for subscribing!"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Band background",
      "default": "#f3eeec"
    },
    {
      "type": "color",
      "id": "copy_color",
      "label": "Copy color",
      "default": "#1d1412"
    },
    {
      "type": "color",
      "id": "input_border",
      "label": "Input border color",
      "default": "#1d1412"
    },
    {
      "type": "color",
      "id": "btn_bg",
      "label": "Button background",
      "default": "#3b2523"
    },
    {
      "type": "color",
      "id": "btn_text",
      "label": "Button text",
      "default": "#ffffff"
    }
  ],
  "presets": [
    { "name": "Newsletter banner" }
  ]
}
{% endschema %}
